

-- CONSULTA PRODUTOS PREÇO E ESTOQUE

	--C@ ADRIANO TOUZO

	--Informar se o produto está em FORA DE LINHA
    --Informar se o produto é  VENDA SOBRE ENCOMENDA
    --Informar a quantidade em estoque ARA e SC.

	--select * from ZZ8010 

SELECT DISTINCT SBM010.BM_GRUPO AS GRUPO, SBM010.BM_DESC AS G_DESCRICAO , ZZ1_MARCA AS MARCA,ZZ1_DESC AS MARCA_DESCRICAO ,B1_COD AS CODIGO ,
				B1_DESC AS PRODUTO , B1_UM AS UN , B1_QE AS LOTE, B1_VENCAS as VENDA_CASADA , B1_CODBAR AS COD_BARRAS , B1_FABRIC AS COD_FABRICANTE, 
				B1_LOCAL1,B1_LOCAL10, B2_FILIAL AS FILIAL,	SUM(B2_QATU) AS ESTOQUE, B1_SUBGRUP, ZZ8_FORAL AS FORA_LINHA
		
		FROM SB1010 B1, ZZ1010 Z1, ZZ3010  Z3, SBM010 SB, SB2010 B2, SBM010, ZZ8010
			
			WHERE	B1_COD = B2_COD AND
					B1_COD = ZZ8_PROD AND
					B1_MARCA = ZZ1_MARCA AND
					B1_SUBGRUP = ZZ3_COD  AND
					B1_GRUPO = SBM010.BM_GRUPO AND
					--B1_MARCA = '' AND
					--B2_QATU <> '0' AND
					B1.D_E_L_E_T_ = ' ' and Z1.D_E_L_E_T_ = ' ' and Z3.D_E_L_E_T_ = ' ' AND SBM010.D_E_L_E_T_ = ' '
			
		GROUP BY	SBM010.BM_GRUPO, SBM010.BM_DESC,ZZ1_MARCA,ZZ1_DESC, B1_COD , B1_DESC , B1_UM , B1_QE , B1_VENCAS , B1_CODBAR , 
					B1_FABRIC, B2_FILIAL, B1_LOCAL1,B1_LOCAL10, B1_SUBGRUP, ZZ8_FORAL

GO

/*
SELECT * FROM Z02010
SELECT * FROM SC6010 SC5010, 
*/

--//// BUSCA PRODUTOS POR ESTOQUE E PODER D TERCEIRO -- ROGERIO 06/01/22
SELECT DISTINCT 
		B1_COD,ZZ3_DESC,B1_DESC AS PRODUTO,ZZ8_MARGEM,ZZ8_FATOR,ZZ8_PRLIST,ZZ8_PRMIN,ZZ8_DESC,B1_QE AS Embalagem,ZZ8_EMBCOM, 
		(SELECT SUM(B2_QATU) FROM SB2010 WHERE B1_COD = B2_COD AND B2_FILIAL = '01') ARA,
		(SELECT SUM(B2_QATU) FROM SB2010 WHERE B1_COD = B2_COD AND B2_FILIAL = '02') SCA,
		(SELECT SUM(B6_SALDO) FROM SB6010 where B2_COD = B6_PRODUTO AND B6_CLIFOR ='098390' AND D_E_L_E_T_ ='')ML_FULL,
		B1_VENCAS
FROM SB1010 B1, ZZ8010 Z8,SB2010 B2,ZZ3010 Z3, SB6010 B6
	WHERE 
					B1_COD = B2_COD AND
					--B6_PRODUTO = B2_COD AND
					B1_COD = ZZ8_PROD AND
					B1_SUBGRUP = ZZ3_COD  AND
					B1.D_E_L_E_T_ = ' ' and Z8.D_E_L_E_T_ = ' ' and B2.D_E_L_E_T_ = ' ' AND
					--B1_VENCAS <> 'S' AND 
					B2_QATU <> '0' --AND
					--B2_COD ='061390001'
GROUP BY B1_COD,ZZ3_DESC,B1_DESC,ZZ8_MARGEM,ZZ8_FATOR,ZZ8_PRLIST,ZZ8_DESC,ZZ8_EMBCOM,B1_FILIAL,B2_COD,B1_VENCAS,B1_QE,ZZ8_PRMIN
ORDER BY 1

--SELECT B1_QE,* FROM SB1010 where B1_COD ='020150039'
--SELECT B2_QATU,* FROM SB2010 
--SELECT * FROM ZZ8010 WHERE ZZ8_PROD ='020150039'
--SELECT SUM(B6_SALDO) FROM SB6010 where B6_CLIFOR ='098390' AND B6_SALDO <>'0' AND B6_PRODUTO ='030430390' AND D_E_L_E_T_ =''