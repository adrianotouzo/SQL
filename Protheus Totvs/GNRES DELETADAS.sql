SELECT E2_PREFIXO+E2_NUM AS GNRE, E2_VALOR,E2_EMISSAO FROM SE2010 WHERE --E2_EMISSAO between '20210101' and '20211231'
 E2_PREFIXO+E2_NUM in 
--UPDATE SE2010 SET D_E_L_E_T_ ='*' WHERE E2_PREFIXO+E2_NUM in
('ICM000025216','ICM000028315','ICM000028315','ICM000028288','ICM000022144','ICM000026295','ICM000026595',
'ICM000026694','ICM000026706','ICM000026813','ICM000026871','ICM000027101','ICM000027403','ICM000027502',
'ICM000027601','ICM000027709','ICM000027710','ICM000027724','ICM000027728','ICM000027741','ICM000027756',
'ICM000027828','ICM000027867','ICM000027880','ICM000027940')

--and E2_BAIXA = '' AND D_E_L_E_T_ =''
--SELECT * FROM SF2010 WHERE F2_DOC = '050657' AND F2_SERIE ='9'


SELECT  F2_DOC,F2_SERIE, F2_EMISSAO, F2_EST,
		F2_CHVNFE,F2_VALBRUT AS VLRNOTA, E2_PREFIXO+E2_NUM,
		E2_PREFIXO+E2_NUM AS GUIA, E2_VALOR AS VLRDIFAL,E2_BAIXA,A1_CGC AS CPF,
	FROM SE2010 SE2, SF2010 SF2, SA1010 SA1

	WHERE E2_PREFIXO+E2_NUM = F2_GNRFECP AND E2_PREFIXO+E2_NUM = F2_GNRDIF AND
		  A1_COD = F2_CLIENTE AND A1_LOJA = F2_LOJA AND
		  E2_EMISSAO between '20200101' and '20220119' 
		  and SE2.D_E_L_E_T_ ='' AND E2_BAIXA = ''

SELECT F2_DOC,F2_SERIE, F2_EMISSAO, F2_EST,F2_CHVNFE,F2_VALBRUT, F2_GNRDIF,F2_GNRFECP
FROM SF2010 
WHERE 
--F2_EMISSAO between '20200101' and '20220119' 
 F2_GNRDIF ='ICM000011031' AND F2_GNRFECP =''


--buscas gnre geral todas pendentes no financeiro.

SELECT F2_DOC,F2_SERIE, E2_PREFIXO+E2_NUM AS GNRE, E2_EMISSAO, E2_VALOR AS VLRDIFAL,E2_BAIXA,
       F2_EMISSAO, F2_EST,F2_CHVNFE,F2_VALBRUT, F2_GNRDIF,F2_GNRFECP
FROM SE2010, SF2010
WHERE 
F2_GNRDIF = E2_PREFIXO+E2_NUM AND
E2_EMISSAO between '20190101' and '20221231' AND E2_BAIXA = '' AND E2_PREFIXO+E2_NUM <> '' AND SE2010.D_E_L_E_T_ =''
ORDER BY 1,3,4

SELECT F2_DOC,F2_SERIE, E2_PREFIXO+E2_NUM AS GNRE, E2_EMISSAO, E2_VALOR AS VLRDIFAL,E2_BAIXA,
       F2_EMISSAO, F2_EST,F2_CHVNFE,F2_VALBRUT, F2_GNRDIF,F2_GNRFECP
FROM SE2010, SF2010
WHERE 
F2_GNRDIF = E2_PREFIXO+E2_NUM AND E2_BAIXA ='' AND SE2010.D_E_L_E_T_ =''
ORDER BY 1,2,3

--COUNT(E2_PREFIXO+E2_NUM)
/*SELECT COUNT(F2_DOC) FROM SF2010 
WHERE F2_SERIE ='9' AND F2_EMISSAO  AND E2_BAIXA = ''
between '20210801' and '20211231' and D_E_L_E_T_ ='' AND F2_EST <> 'SP'

SELECT F3_PRTDNF,F3_P,* FROM SF3010 
*/

SELECT F2_DOC NOTA ,F2_SERIE SERIE,
CONVERT(varchar, CAST(F2_EMISSAO AS datetime), 103) EMISSAO,
F2_EST EST,A1_CGC CPF,F2_CHVNFE CHVNFE,F2_VALBRUT VLRNOTA,E2_PREFIXO+E2_NUM  GUIA, E2_VALOR VLRDIFAL,
CONVERT(varchar, CAST(E2_BAIXA AS datetime), 103) PGTO

FROM SF2010 F2 WITH(NOLOCK) 
INNER JOIN SE2010 E2 WITH(NOLOCK) ON (E2_PREFIXO+E2_NUM = F2_GNRFECP OR E2_PREFIXO+E2_NUM = F2_GNRDIF) AND E2.D_E_L_E_T_ =''
AND E2_BAIXA = ''
INNER JOIN SA1010 A1 WITH(NOLOCK) ON A1_COD = F2_CLIENTE AND A1_LOJA = F2_LOJA AND A1.D_E_L_E_T_ ='' 
WHERE  F2.D_E_L_E_T_ =''
ORDER BY 1

