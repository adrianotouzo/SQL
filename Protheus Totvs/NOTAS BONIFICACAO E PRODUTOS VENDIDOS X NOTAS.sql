-- NUMERO DE PRODUTOS E NOTAS QUE FORAM VENDIDOS. ROGERIO

SELECT DISTINCT D2_COD,D2_NOMPRO,
				SUM(D2_QUANT)AS Q_PRODUTOS, COUNT(D2_DOC)AS T_NOTAS,
				(SELECT B1_LOCAL1 FROM SB1010 WHERE B1_COD = D2_COD) AS ARMAZEM01,
				(SELECT B1_LOCAL2 FROM SB1010 WHERE B1_COD = D2_COD) AS ARMAZEM02,
				(SELECT B1_LOCAL3 FROM SB1010 WHERE B1_COD = D2_COD) AS ARMAZEM03				
	FROM SD2010, SB1010 
	WHERE 
	D2_COD = B1_COD AND 
	D2_EMISSAO BETWEEN '20210101' AND '20211231' AND SD2010.D_E_L_E_T_ =''
GROUP BY D2_COD,D2_NOMPRO, D2_QUANT
ORDER BY 4 DESC

SELECT * FROM SB1010

SELECT D1_EMISSAO,D1_DOC,
       D1_FORNECE,(SELECT A2_NOME FROM SA2010 WHERE A2_COD = D1_FORNECE AND A2_LOJA = D1_LOJA)FORNECEDOR,
	   D1_COD, D1_DESCR, SUM(D1_QUANT)AS Q_PRODUTOS,
	   D1_VUNIT, 
	   (SELECT SUM(F1_VALBRUT) FROM SF1010 WHERE D1_DOC = F1_DOC) VALORNF
	FROM SD1010, SF1010,SA2010  
	WHERE F1_DOC = D1_DOC AND  D1_TES = '289' AND 
		  A2_COD = D1_FORNECE AND A2_LOJA = D1_LOJA AND 
          D1_EMISSAO BETWEEN '20210101' AND '20211231'
		  AND SD1010.D_E_L_E_T_ =''
GROUP BY D1_EMISSAO,D1_FORNECE,D1_DESCR,F1_VALBRUT,D1_DOC,D1_VUNIT,D1_COD, A2_NOME, D1_LOJA
ORDER BY 1,2

